<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>actxps - Experience summaries</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">actxps</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../articles/actxps.html" rel="" target="">
 <span class="menu-text">Get started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../reference/index.html" rel="" target="">
 <span class="menu-text">Reference</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-articles" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Articles</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-articles">    
        <li>
    <a class="dropdown-item" href="../articles/exposures.html" rel="" target="">
 <span class="dropdown-text">Exposure calculations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/exp_summary.html" rel="" target="">
 <span class="dropdown-text">Experience summaries</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/transactions.html" rel="" target="">
 <span class="dropdown-text">Transaction studies</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/visualizations.html" rel="" target="">
 <span class="dropdown-text">Data visualizations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/misc.html" rel="" target="">
 <span class="dropdown-text">Other functions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../changelog.html" rel="" target="">
 <span class="menu-text">Changelog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mattheaphy/actxpspy" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-r-circle-fill" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-r-circle-fill" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-r-circle-fill">    
        <li class="dropdown-header">R version of actxps</li>
        <li>
    <a class="dropdown-item" href="https://github.com/mattheaphy/actxps" rel="" target="">
 <span class="dropdown-text">Source code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://mattheaphy.github.io/actxps" rel="" target="">
 <span class="dropdown-text">Package documentation</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-exp_stats-method" id="toc-the-exp_stats-method" class="nav-link active" data-scroll-target="#the-exp_stats-method">The <code>exp_stats()</code> method</a>
  <ul class="collapse">
  <li><a href="#grouped-data" id="toc-grouped-data" class="nav-link" data-scroll-target="#grouped-data">Grouped data</a></li>
  <li><a href="#target-status" id="toc-target-status" class="nav-link" data-scroll-target="#target-status">Target status</a></li>
  </ul></li>
  <li><a href="#weighted-results" id="toc-weighted-results" class="nav-link" data-scroll-target="#weighted-results">Weighted results</a></li>
  <li><a href="#expected-values-and-ae-ratios" id="toc-expected-values-and-ae-ratios" class="nav-link" data-scroll-target="#expected-values-and-ae-ratios">Expected values and A/E ratios</a></li>
  <li><a href="#credibility" id="toc-credibility" class="nav-link" data-scroll-target="#credibility">Credibility</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">Confidence intervals</a></li>
  <li><a href="#miscellaneous" id="toc-miscellaneous" class="nav-link" data-scroll-target="#miscellaneous">Miscellaneous</a>
  <ul class="collapse">
  <li><a href="#summary-method" id="toc-summary-method" class="nav-link" data-scroll-target="#summary-method">Summary method</a></li>
  <li><a href="#column-names" id="toc-column-names" class="nav-link" data-scroll-target="#column-names">Column names</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Experience summaries</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>After experience data has been prepared for analysis, the next step is to summarize results. The actxps package’s workhorse function for summarizing termination experience is the <code>exp_stats()</code> method of the <code>ExposedDF</code> class. This function returns an <code>ExpStats</code> object, which is a type of data frame containing additional attributes about the experience study.</p>
<p>At a minimum, an <code>ExpStats</code> includes:</p>
<ul>
<li>The number of claims (termination events, <code>n_claims</code>)</li>
<li>The amount of claims (weighted by a variable of the user’s choice; more on this below, <code>claims</code>)</li>
<li>The total exposure (<code>exposure</code>)</li>
<li>The observed termination rate (<code>q_obs</code>)</li>
</ul>
<p>Optionally, an <code>ExpStats</code> can also include:</p>
<ul>
<li>Any grouping variables attached to the input data</li>
<li>Expected termination rates and actual-to-expected (A/E) ratios (<code>ae_*</code>)</li>
<li>Limited fluctuation credibility estimates (<code>credibility</code>) and credibility-adjusted expected termination rates (<code>adj_*</code>)</li>
</ul>
<p>To demonstrate this function, we’re going to use a data frame containing simulated census data for a theoretical deferred annuity product that has an optional guaranteed income rider. Before <code>exp_stats()</code> can be used, we must convert our census data into exposure records using the <code>ExposedDF()</code> class<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. In addition, let’s assume we’re interested in studying surrender rates, so we’ll pass the argument <code>target_status='Surrender'</code> to <code>ExposedDF()</code>.</p>
<div id="packages" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> actxps <span class="im">as</span> xp</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>census_dat <span class="op">=</span> xp.load_census_dat()</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>exposed_data <span class="op">=</span> xp.ExposedDF(census_dat, end_date<span class="op">=</span><span class="st">"2019-12-31"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                            target_status<span class="op">=</span><span class="st">"Surrender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-exp_stats-method" class="level2">
<h2 class="anchored" data-anchor-id="the-exp_stats-method">The <code>exp_stats()</code> method</h2>
<p>To use <code>exp_stats()</code>, simply call the method from an <code>ExposedDF</code> object.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>exposed_data.exp_stats()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="xp-basic" class="cell-output cell-output-display" data-execution_count="3">
<pre><code>Experience study results

Target status: Surrender
Study range: 1900-01-01 to 2019-12-31

shape: (1, 4)
┌──────────┬────────┬───────────────┬──────────┐
│ n_claims ┆ claims ┆ exposure      ┆ q_obs    │
│ ---      ┆ ---    ┆ ---           ┆ ---      │
│ u32      ┆ u32    ┆ f64           ┆ f64      │
╞══════════╪════════╪═══════════════╪══════════╡
│ 2869     ┆ 2869   ┆ 132633.900756 ┆ 0.021631 │
└──────────┴────────┴───────────────┴──────────┘</code></pre>
</div>
</div>
<p>The results show us that we specified no groups, which is why the output data is a single row. In addition, we can see that we’re looking at surrender rates through the end of 2019, which <code>exp_stats()</code> inferred from <code>exposed_data</code>.</p>
<p>The number of claims (<code>n_claims</code>) is equal to the number of “Surrender” statuses in <code>exposed_data</code>. Since we didn’t specify any weighting variable, the amount of claims (<code>claims</code>) equals the number of claims.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>amount <span class="op">=</span> <span class="bu">sum</span>(exposed_data.data[<span class="st">"status"</span>] <span class="op">==</span> <span class="st">"Surrender"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>amount</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="claim-check" class="cell-output cell-output-display" data-execution_count="4">
<pre><code>2869</code></pre>
</div>
</div>
<p>The total exposure (<code>exposure</code>) is equal to the sum of the exposures in <code>exposed_data</code>. Had we specified a weighting variable, this would be equal to the sum of weighted exposures.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sum_expo <span class="op">=</span> <span class="bu">sum</span>(exposed_data.data[<span class="st">'exposure'</span>])</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>sum_expo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="expo-check" class="cell-output cell-output-display" data-execution_count="5">
<pre><code>132633.90075604623</code></pre>
</div>
</div>
<p>Lastly, the observed termination rate (<code>q_obs</code>) equals the amount of claims divided by the exposures.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>amount <span class="op">/</span> sum_expo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="q-check" class="cell-output cell-output-display" data-execution_count="6">
<pre><code>0.021630970541060664</code></pre>
</div>
</div>
<section id="grouped-data" class="level3">
<h3 class="anchored" data-anchor-id="grouped-data">Grouped data</h3>
<p>If the data is grouped using the <code>group_by()</code> method, future calls to <code>exp_stats()</code> will contain one record for each unique group.</p>
<p>In the following, <code>exposed_data</code> is grouped by policy year before <code>exp_stats()</code> is called. This results in one row per policy year found in the data.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(exposed_data.</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    group_by(<span class="st">'pol_yr'</span>).</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    exp_stats())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="grouped-1" class="cell-output cell-output-display" data-execution_count="7">
<pre><code>Experience study results

Groups: pol_yr
Target status: Surrender
Study range: 1900-01-01 to 2019-12-31

shape: (15, 5)
┌────────┬──────────┬────────┬──────────────┬──────────┐
│ pol_yr ┆ n_claims ┆ claims ┆ exposure     ┆ q_obs    │
│ ---    ┆ ---      ┆ ---    ┆ ---          ┆ ---      │
│ u32    ┆ u32      ┆ u32    ┆ f64          ┆ f64      │
╞════════╪══════════╪════════╪══════════════╪══════════╡
│ 1      ┆ 102      ┆ 102    ┆ 19252.207785 ┆ 0.005298 │
│ 2      ┆ 160      ┆ 160    ┆ 17714.766674 ┆ 0.009032 │
│ 3      ┆ 124      ┆ 124    ┆ 16097.130504 ┆ 0.007703 │
│ 4      ┆ 168      ┆ 168    ┆ 14535.853836 ┆ 0.011558 │
│ 5      ┆ 164      ┆ 164    ┆ 12915.522726 ┆ 0.012698 │
│ …      ┆ …        ┆ …      ┆ …            ┆ …        │
│ 11     ┆ 804      ┆ 804    ┆ 4390.391496  ┆ 0.183127 │
│ 12     ┆ 330      ┆ 330    ┆ 2663.379931  ┆ 0.123903 │
│ 13     ┆ 99       ┆ 99     ┆ 1619.90935   ┆ 0.061115 │
│ 14     ┆ 62       ┆ 62     ┆ 871.838738   ┆ 0.071114 │
│ 15     ┆ 17       ┆ 17     ┆ 268.175058   ┆ 0.063391 │
└────────┴──────────┴────────┴──────────────┴──────────┘</code></pre>
</div>
</div>
<p>Multiple grouping variables are allowed. Below, the presence of an income guarantee (<code>inc_guar</code>) is added as a second grouping variable.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(exposed_data.</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    group_by(<span class="st">'inc_guar'</span>, <span class="st">'pol_yr'</span>).</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    exp_stats())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="grouped-2" class="cell-output cell-output-display" data-execution_count="8">
<pre><code>Experience study results

Groups: inc_guar, pol_yr
Target status: Surrender
Study range: 1900-01-01 to 2019-12-31

shape: (30, 6)
┌──────────┬────────┬──────────┬────────┬─────────────┬──────────┐
│ inc_guar ┆ pol_yr ┆ n_claims ┆ claims ┆ exposure    ┆ q_obs    │
│ ---      ┆ ---    ┆ ---      ┆ ---    ┆ ---         ┆ ---      │
│ bool     ┆ u32    ┆ u32      ┆ u32    ┆ f64         ┆ f64      │
╞══════════╪════════╪══════════╪════════╪═════════════╪══════════╡
│ false    ┆ 1      ┆ 56       ┆ 56     ┆ 7719.80545  ┆ 0.007254 │
│ false    ┆ 2      ┆ 92       ┆ 92     ┆ 7102.810869 ┆ 0.012953 │
│ false    ┆ 3      ┆ 67       ┆ 67     ┆ 6446.913856 ┆ 0.010393 │
│ false    ┆ 4      ┆ 123      ┆ 123    ┆ 5798.905846 ┆ 0.021211 │
│ false    ┆ 5      ┆ 97       ┆ 97     ┆ 5105.874571 ┆ 0.018998 │
│ …        ┆ …      ┆ …        ┆ …      ┆ …           ┆ …        │
│ true     ┆ 11     ┆ 347      ┆ 347    ┆ 2696.774512 ┆ 0.128672 │
│ true     ┆ 12     ┆ 150      ┆ 150    ┆ 1768.300449 ┆ 0.084827 │
│ true     ┆ 13     ┆ 49       ┆ 49     ┆ 1117.137361 ┆ 0.043862 │
│ true     ┆ 14     ┆ 29       ┆ 29     ┆ 609.216476  ┆ 0.047602 │
│ true     ┆ 15     ┆ 9        ┆ 9      ┆ 194.128602  ┆ 0.046361 │
└──────────┴────────┴──────────┴────────┴─────────────┴──────────┘</code></pre>
</div>
</div>
<p>Grouping persists after <code>group_by()</code> is called. To remove groups, the <code>ungroup()</code> method can be used.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check groups</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(exposed_data.groups)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['inc_guar', 'pol_yr']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ungroup, then check groups again</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>exposed_data.ungroup()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(exposed_data.groups <span class="kw">is</span> <span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True</code></pre>
</div>
</div>
</section>
<section id="target-status" class="level3">
<h3 class="anchored" data-anchor-id="target-status">Target status</h3>
<p>The <code>target_status</code> argument of <code>exp_stats()</code> specifies which status levels count as claims in the experience study summary. If the <code>ExposedDF</code> object already has a specified target status (from the original call to <code>ExposedDF()</code>), then this argument is not necessary because the target status is automatically inferred.</p>
<p>Even if the target status exists, it can be overridden. However care should be taken to ensure that exposure values in the data are appropriate for the new status.</p>
<p>Using the example data, a total termination rate can be estimated by including both death and surrender statuses in <code>target_status</code>. To ensure exposures are accurate, an adjustment is made to fully expose deaths prior to calling <code>exp_stats()</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> deepcopy</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>exposed_data2 <span class="op">=</span> deepcopy(exposed_data)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>exposed_data2.data <span class="op">=</span> exposed_data2.data.with_columns(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    exposure<span class="op">=</span>pl.when(pl.col(<span class="st">'status'</span>) <span class="op">==</span> <span class="st">"Death"</span>).</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>             then(<span class="dv">1</span>).</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>             otherwise(<span class="st">'exposure'</span>))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>(exposed_data2.group_by(<span class="st">'pol_yr'</span>).</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    exp_stats(target_status<span class="op">=</span>[<span class="st">"Surrender"</span>, <span class="st">"Death"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="targ-status" class="cell-output cell-output-display" data-execution_count="11">
<pre><code>Experience study results

Groups: pol_yr
Target status: Surrender, Death
Study range: 1900-01-01 to 2019-12-31

shape: (15, 5)
┌────────┬──────────┬────────┬──────────────┬──────────┐
│ pol_yr ┆ n_claims ┆ claims ┆ exposure     ┆ q_obs    │
│ ---    ┆ ---      ┆ ---    ┆ ---          ┆ ---      │
│ u32    ┆ u32      ┆ u32    ┆ f64          ┆ f64      │
╞════════╪══════════╪════════╪══════════════╪══════════╡
│ 1      ┆ 290      ┆ 290    ┆ 19348.981503 ┆ 0.014988 │
│ 2      ┆ 325      ┆ 325    ┆ 17796.237974 ┆ 0.018262 │
│ 3      ┆ 292      ┆ 292    ┆ 16180.423288 ┆ 0.018046 │
│ 4      ┆ 329      ┆ 329    ┆ 14611.259915 ┆ 0.022517 │
│ 5      ┆ 329      ┆ 329    ┆ 12997.509829 ┆ 0.025313 │
│ …      ┆ …        ┆ …      ┆ …            ┆ …        │
│ 11     ┆ 894      ┆ 894    ┆ 4441.488278  ┆ 0.201284 │
│ 12     ┆ 398      ┆ 398    ┆ 2696.530653  ┆ 0.147597 │
│ 13     ┆ 131      ┆ 131    ┆ 1634.27666   ┆ 0.080158 │
│ 14     ┆ 89       ┆ 89     ┆ 886.369047   ┆ 0.10041  │
│ 15     ┆ 23       ┆ 23     ┆ 272.057407   ┆ 0.084541 │
└────────┴──────────┴────────┴──────────────┴──────────┘</code></pre>
</div>
</div>
</section>
</section>
<section id="weighted-results" class="level2">
<h2 class="anchored" data-anchor-id="weighted-results">Weighted results</h2>
<p>Experience studies often weight output by key policy values. Examples include account values, cash values, face amount, premiums, and more. Weighting can be accomplished by passing the name of a weighting column to the <code>wt</code> argument of <code>exp_stats()</code>.</p>
<p>Our sample data contains a column called <code>premium</code> that we can weight by. When weights are supplied, the <code>claims</code>, <code>exposure</code>, and <code>q_obs</code> columns will be weighted. If expected termination rates are supplied (see below), these rates and A/E values will also be weighted.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  label: weight-res</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>(exposed_data.</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    group_by(<span class="st">'pol_yr'</span>).</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    exp_stats(wt<span class="op">=</span><span class="st">'premium'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>Experience study results

Groups: pol_yr
Target status: Surrender
Study range: 1900-01-01 to 2019-12-31
Weighted by: premium

shape: (15, 8)
┌────────┬──────────┬──────────┬───────────────┬──────────┬─────────────┬───────────┬──────────┐
│ pol_yr ┆ n_claims ┆ claims   ┆ exposure      ┆ q_obs    ┆ weight      ┆ weight_sq ┆ weight_n │
│ ---    ┆ ---      ┆ ---      ┆ ---           ┆ ---      ┆ ---         ┆ ---       ┆ ---      │
│ u32    ┆ u32      ┆ f64      ┆ f64           ┆ f64      ┆ f64         ┆ f64       ┆ i32      │
╞════════╪══════════╪══════════╪═══════════════╪══════════╪═════════════╪═══════════╪══════════╡
│ 1      ┆ 102      ┆ 83223.0  ┆ 2.5313e7      ┆ 0.003288 ┆ 2.6301746e7 ┆ 6.0743e10 ┆ 19995    │
│ 2      ┆ 160      ┆ 170058.0 ┆ 2.3352e7      ┆ 0.007282 ┆ 2.4275265e7 ┆ 5.6233e10 ┆ 18434    │
│ 3      ┆ 124      ┆ 123554.0 ┆ 2.1247e7      ┆ 0.005815 ┆ 2.2201817e7 ┆ 5.1747e10 ┆ 16806    │
│ 4      ┆ 168      ┆ 176751.0 ┆ 1.9271e7      ┆ 0.009172 ┆ 2.0200019e7 ┆ 4.7142e10 ┆ 15266    │
│ 5      ┆ 164      ┆ 173273.0 ┆ 1.7229e7      ┆ 0.010057 ┆ 1.8134795e7 ┆ 4.2888e10 ┆ 13618    │
│ …      ┆ …        ┆ …        ┆ …             ┆ …        ┆ …           ┆ …         ┆ …        │
│ 11     ┆ 804      ┆ 856379.0 ┆ 6.0932e6      ┆ 0.140547 ┆ 6.783273e6  ┆ 1.6220e10 ┆ 4897     │
│ 12     ┆ 330      ┆ 383055.0 ┆ 3.8835e6      ┆ 0.098636 ┆ 4.525027e6  ┆ 1.1191e10 ┆ 3093     │
│ 13     ┆ 99       ┆ 123357.0 ┆ 2.4503e6      ┆ 0.050344 ┆ 2.891573e6  ┆ 7.0759e9  ┆ 1937     │
│ 14     ┆ 62       ┆ 75534.0  ┆ 1.3392e6      ┆ 0.056401 ┆ 1.821026e6  ┆ 4.6557e9  ┆ 1182     │
│ 15     ┆ 17       ┆ 19168.0  ┆ 401169.299296 ┆ 0.04778  ┆ 783146.0    ┆ 1.9448e9  ┆ 510      │
└────────┴──────────┴──────────┴───────────────┴──────────┴─────────────┴───────────┴──────────┘</code></pre>
</div>
</div>
</section>
<section id="expected-values-and-ae-ratios" class="level2">
<h2 class="anchored" data-anchor-id="expected-values-and-ae-ratios">Expected values and A/E ratios</h2>
<p>As common metric in experience studies is the actual-to-expected, or A/E ratio.</p>
<p><span class="math display">\[
A/E\ ratio = \frac{observed\ value}{expected\ value}
\]</span></p>
<p>If the data passed to <code>exp_stats()</code> has one or more columns containing expected termination rates, A/E ratios can be calculated by passing the names of these columns to the <code>expected</code> argument.</p>
<p>Let’s assume we have two sets of expected rates. The first set is a vector that varies by policy year. The second set is either 1.5% or 3.0% depending on whether the policy has a guaranteed income benefit. First, we need to attach these assumptions to our exposure data. We will use the names <code>expected_1</code> and <code>expected_2</code>. Then we pass these names to the <code>expected</code> argument when we call <code>exp_stats()</code>.</p>
<p>In the output, 4 new columns are created for expected rates and A/E ratios.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>expected_table <span class="op">=</span> np.concatenate((np.linspace(<span class="fl">0.005</span>, <span class="fl">0.03</span>, <span class="dv">10</span>),</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                                 [<span class="fl">.2</span>, <span class="fl">.15</span>], np.repeat(<span class="fl">0.05</span>, <span class="dv">3</span>)))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># using 2 different expected termination rates</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>exposed_data.data <span class="op">=</span> exposed_data.data.with_columns(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    expected_1<span class="op">=</span>expected_table[exposed_data.data[<span class="st">'pol_yr'</span>] <span class="op">-</span> <span class="dv">1</span>],</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    expected_2<span class="op">=</span>pl.when(pl.col(<span class="st">'inc_guar'</span>)).then(<span class="fl">0.015</span>).otherwise(<span class="fl">0.03</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>exp_res <span class="op">=</span> (exposed_data.</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>           group_by(<span class="st">"pol_yr"</span>, <span class="st">"inc_guar"</span>).</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>           exp_stats(expected<span class="op">=</span>[<span class="st">"expected_1"</span>, <span class="st">"expected_2"</span>]))</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>exp_res.data.select(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>, <span class="st">'q_obs'</span>, pl.col(<span class="st">'^.*expected.*$'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="act-exp" class="cell-output cell-output-display" data-execution_count="13">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (30, 7)</small>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">pol_yr</th>
<th data-quarto-table-cell-role="th">inc_guar</th>
<th data-quarto-table-cell-role="th">q_obs</th>
<th data-quarto-table-cell-role="th">expected_1</th>
<th data-quarto-table-cell-role="th">expected_2</th>
<th data-quarto-table-cell-role="th">ae_expected_1</th>
<th data-quarto-table-cell-role="th">ae_expected_2</th>
</tr>
<tr class="odd">
<th>u32</th>
<th>bool</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>false</td>
<td>0.007254</td>
<td>0.005</td>
<td>0.03</td>
<td>1.450814</td>
<td>0.241802</td>
</tr>
<tr class="even">
<td>1</td>
<td>true</td>
<td>0.003989</td>
<td>0.005</td>
<td>0.015</td>
<td>0.797752</td>
<td>0.265917</td>
</tr>
<tr class="odd">
<td>2</td>
<td>false</td>
<td>0.012953</td>
<td>0.007778</td>
<td>0.03</td>
<td>1.665337</td>
<td>0.431754</td>
</tr>
<tr class="even">
<td>2</td>
<td>true</td>
<td>0.006408</td>
<td>0.007778</td>
<td>0.015</td>
<td>0.823869</td>
<td>0.427191</td>
</tr>
<tr class="odd">
<td>3</td>
<td>false</td>
<td>0.010393</td>
<td>0.010556</td>
<td>0.03</td>
<td>0.984559</td>
<td>0.346419</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>13</td>
<td>true</td>
<td>0.043862</td>
<td>0.05</td>
<td>0.015</td>
<td>0.877242</td>
<td>2.924141</td>
</tr>
<tr class="even">
<td>14</td>
<td>false</td>
<td>0.125656</td>
<td>0.05</td>
<td>0.03</td>
<td>2.513115</td>
<td>4.188525</td>
</tr>
<tr class="odd">
<td>14</td>
<td>true</td>
<td>0.047602</td>
<td>0.05</td>
<td>0.015</td>
<td>0.952043</td>
<td>3.173475</td>
</tr>
<tr class="even">
<td>15</td>
<td>false</td>
<td>0.10804</td>
<td>0.05</td>
<td>0.03</td>
<td>2.160806</td>
<td>3.601343</td>
</tr>
<tr class="odd">
<td>15</td>
<td>true</td>
<td>0.046361</td>
<td>0.05</td>
<td>0.015</td>
<td>0.92722</td>
<td>3.090735</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>As noted above, if weights are passed to <code>exp_stats()</code> then A/E ratios will also be weighted.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>exp_res_wt <span class="op">=</span> (exposed_data.</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>              group_by(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>).</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>              exp_stats(expected<span class="op">=</span>[<span class="st">"expected_1"</span>, <span class="st">"expected_2"</span>],</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                        wt<span class="op">=</span><span class="st">"premium"</span>))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>exp_res_wt.data.select(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>, <span class="st">'q_obs'</span>, pl.col(<span class="st">'^.*expected.*$'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="act-exp-wt" class="cell-output cell-output-display" data-execution_count="14">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (30, 7)</small>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">pol_yr</th>
<th data-quarto-table-cell-role="th">inc_guar</th>
<th data-quarto-table-cell-role="th">q_obs</th>
<th data-quarto-table-cell-role="th">expected_1</th>
<th data-quarto-table-cell-role="th">expected_2</th>
<th data-quarto-table-cell-role="th">ae_expected_1</th>
<th data-quarto-table-cell-role="th">ae_expected_2</th>
</tr>
<tr class="odd">
<th>u32</th>
<th>bool</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>false</td>
<td>0.004709</td>
<td>0.005</td>
<td>0.03</td>
<td>0.94182</td>
<td>0.15697</td>
</tr>
<tr class="even">
<td>1</td>
<td>true</td>
<td>0.002351</td>
<td>0.005</td>
<td>0.015</td>
<td>0.470113</td>
<td>0.156704</td>
</tr>
<tr class="odd">
<td>2</td>
<td>false</td>
<td>0.01054</td>
<td>0.007778</td>
<td>0.03</td>
<td>1.355163</td>
<td>0.351339</td>
</tr>
<tr class="even">
<td>2</td>
<td>true</td>
<td>0.005132</td>
<td>0.007778</td>
<td>0.015</td>
<td>0.659867</td>
<td>0.342153</td>
</tr>
<tr class="odd">
<td>3</td>
<td>false</td>
<td>0.007373</td>
<td>0.010556</td>
<td>0.03</td>
<td>0.698464</td>
<td>0.245756</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>13</td>
<td>true</td>
<td>0.038539</td>
<td>0.05</td>
<td>0.015</td>
<td>0.770787</td>
<td>2.569291</td>
</tr>
<tr class="even">
<td>14</td>
<td>false</td>
<td>0.096951</td>
<td>0.05</td>
<td>0.03</td>
<td>1.939013</td>
<td>3.231688</td>
</tr>
<tr class="odd">
<td>14</td>
<td>true</td>
<td>0.036829</td>
<td>0.05</td>
<td>0.015</td>
<td>0.736585</td>
<td>2.455285</td>
</tr>
<tr class="even">
<td>15</td>
<td>false</td>
<td>0.066551</td>
<td>0.05</td>
<td>0.03</td>
<td>1.331026</td>
<td>2.218377</td>
</tr>
<tr class="odd">
<td>15</td>
<td>true</td>
<td>0.039654</td>
<td>0.05</td>
<td>0.015</td>
<td>0.793086</td>
<td>2.64362</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="credibility" class="level2">
<h2 class="anchored" data-anchor-id="credibility">Credibility</h2>
<p>If the <code>credibility</code> argument is set to <code>True</code>, <code>exp_stats()</code> will produce an estimate of partial credibility under the Limited Fluctuation credibility method (also known as Classical Credibility) assuming a binomial distribution of claims.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(exposed_data.</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    group_by(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>).</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    exp_stats(credibility<span class="op">=</span><span class="va">True</span>).</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    data.select(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>, <span class="st">'claims'</span>, <span class="st">'q_obs'</span>, <span class="st">'credibility'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cred1" class="cell-output cell-output-display" data-execution_count="15">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (30, 5)</small>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">pol_yr</th>
<th data-quarto-table-cell-role="th">inc_guar</th>
<th data-quarto-table-cell-role="th">claims</th>
<th data-quarto-table-cell-role="th">q_obs</th>
<th data-quarto-table-cell-role="th">credibility</th>
</tr>
<tr class="odd">
<th>u32</th>
<th>bool</th>
<th>u32</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>false</td>
<td>56</td>
<td>0.007254</td>
<td>0.191601</td>
</tr>
<tr class="even">
<td>1</td>
<td>true</td>
<td>46</td>
<td>0.003989</td>
<td>0.173368</td>
</tr>
<tr class="odd">
<td>2</td>
<td>false</td>
<td>92</td>
<td>0.012953</td>
<td>0.24629</td>
</tr>
<tr class="even">
<td>2</td>
<td>true</td>
<td>68</td>
<td>0.006408</td>
<td>0.211044</td>
</tr>
<tr class="odd">
<td>3</td>
<td>false</td>
<td>67</td>
<td>0.010393</td>
<td>0.209907</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>13</td>
<td>true</td>
<td>49</td>
<td>0.043862</td>
<td>0.182625</td>
</tr>
<tr class="even">
<td>14</td>
<td>false</td>
<td>33</td>
<td>0.125656</td>
<td>0.156725</td>
</tr>
<tr class="odd">
<td>14</td>
<td>true</td>
<td>29</td>
<td>0.047602</td>
<td>0.140771</td>
</tr>
<tr class="even">
<td>15</td>
<td>false</td>
<td>8</td>
<td>0.10804</td>
<td>0.0764</td>
</tr>
<tr class="odd">
<td>15</td>
<td>true</td>
<td>9</td>
<td>0.046361</td>
<td>0.07837</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Under the default arguments, credibility calculations assume a 95% confidence of being within 5% of the true value. These parameters can be overridden using the <code>conf_level</code> and <code>cred_r</code> arguments, respectively.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(exposed_data.</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    group_by(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>).</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    exp_stats(credibility<span class="op">=</span><span class="va">True</span>, conf_level<span class="op">=</span><span class="fl">0.98</span>, cred_r<span class="op">=</span><span class="fl">0.03</span>).</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    data.select(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>, <span class="st">'claims'</span>, <span class="st">'q_obs'</span>, <span class="st">'credibility'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cred2" class="cell-output cell-output-display" data-execution_count="16">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (30, 5)</small>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">pol_yr</th>
<th data-quarto-table-cell-role="th">inc_guar</th>
<th data-quarto-table-cell-role="th">claims</th>
<th data-quarto-table-cell-role="th">q_obs</th>
<th data-quarto-table-cell-role="th">credibility</th>
</tr>
<tr class="odd">
<th>u32</th>
<th>bool</th>
<th>u32</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>false</td>
<td>56</td>
<td>0.007254</td>
<td>0.096855</td>
</tr>
<tr class="even">
<td>1</td>
<td>true</td>
<td>46</td>
<td>0.003989</td>
<td>0.087638</td>
</tr>
<tr class="odd">
<td>2</td>
<td>false</td>
<td>92</td>
<td>0.012953</td>
<td>0.124501</td>
</tr>
<tr class="even">
<td>2</td>
<td>true</td>
<td>68</td>
<td>0.006408</td>
<td>0.106683</td>
</tr>
<tr class="odd">
<td>3</td>
<td>false</td>
<td>67</td>
<td>0.010393</td>
<td>0.106109</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>13</td>
<td>true</td>
<td>49</td>
<td>0.043862</td>
<td>0.092318</td>
</tr>
<tr class="even">
<td>14</td>
<td>false</td>
<td>33</td>
<td>0.125656</td>
<td>0.079225</td>
</tr>
<tr class="odd">
<td>14</td>
<td>true</td>
<td>29</td>
<td>0.047602</td>
<td>0.07116</td>
</tr>
<tr class="even">
<td>15</td>
<td>false</td>
<td>8</td>
<td>0.10804</td>
<td>0.038621</td>
</tr>
<tr class="odd">
<td>15</td>
<td>true</td>
<td>9</td>
<td>0.046361</td>
<td>0.039616</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>If expected values are passed to <code>exp_stats()</code> and <code>credibility</code> is set to <code>True</code>, then the output will also contain credibility-weighted expected values:</p>
<p><span class="math display">\[
q^{adj} = Z^{cred} \times q^{obs} + (1-Z^{cred}) \times q^{exp}
\]</span> where,</p>
<ul>
<li><span class="math inline">\(q^{adj}\)</span> = credibility-weighted estimate</li>
<li><span class="math inline">\(Z^{cred}\)</span> = partial credibility factor</li>
<li><span class="math inline">\(q^{obs}\)</span> = observed termination rate</li>
<li><span class="math inline">\(q^{exp}\)</span> = expected termination rate</li>
</ul>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(exposed_data.</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    group_by(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>).</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    exp_stats(credibility<span class="op">=</span><span class="va">True</span>, expected<span class="op">=</span><span class="st">'expected_1'</span>).</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    data.select(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>, <span class="st">'claims'</span>, <span class="st">'q_obs'</span>, <span class="st">'credibility'</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                pl.col(<span class="st">'^.*expected.*$'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cred3" class="cell-output cell-output-display" data-execution_count="17">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (30, 8)</small>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">pol_yr</th>
<th data-quarto-table-cell-role="th">inc_guar</th>
<th data-quarto-table-cell-role="th">claims</th>
<th data-quarto-table-cell-role="th">q_obs</th>
<th data-quarto-table-cell-role="th">credibility</th>
<th data-quarto-table-cell-role="th">expected_1</th>
<th data-quarto-table-cell-role="th">ae_expected_1</th>
<th data-quarto-table-cell-role="th">adj_expected_1</th>
</tr>
<tr class="odd">
<th>u32</th>
<th>bool</th>
<th>u32</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>false</td>
<td>56</td>
<td>0.007254</td>
<td>0.191601</td>
<td>0.005</td>
<td>1.450814</td>
<td>0.005432</td>
</tr>
<tr class="even">
<td>1</td>
<td>true</td>
<td>46</td>
<td>0.003989</td>
<td>0.173368</td>
<td>0.005</td>
<td>0.797752</td>
<td>0.004825</td>
</tr>
<tr class="odd">
<td>2</td>
<td>false</td>
<td>92</td>
<td>0.012953</td>
<td>0.24629</td>
<td>0.007778</td>
<td>1.665337</td>
<td>0.009052</td>
</tr>
<tr class="even">
<td>2</td>
<td>true</td>
<td>68</td>
<td>0.006408</td>
<td>0.211044</td>
<td>0.007778</td>
<td>0.823869</td>
<td>0.007489</td>
</tr>
<tr class="odd">
<td>3</td>
<td>false</td>
<td>67</td>
<td>0.010393</td>
<td>0.209907</td>
<td>0.010556</td>
<td>0.984559</td>
<td>0.010521</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>13</td>
<td>true</td>
<td>49</td>
<td>0.043862</td>
<td>0.182625</td>
<td>0.05</td>
<td>0.877242</td>
<td>0.048879</td>
</tr>
<tr class="even">
<td>14</td>
<td>false</td>
<td>33</td>
<td>0.125656</td>
<td>0.156725</td>
<td>0.05</td>
<td>2.513115</td>
<td>0.061857</td>
</tr>
<tr class="odd">
<td>14</td>
<td>true</td>
<td>29</td>
<td>0.047602</td>
<td>0.140771</td>
<td>0.05</td>
<td>0.952043</td>
<td>0.049662</td>
</tr>
<tr class="even">
<td>15</td>
<td>false</td>
<td>8</td>
<td>0.10804</td>
<td>0.0764</td>
<td>0.05</td>
<td>2.160806</td>
<td>0.054434</td>
</tr>
<tr class="odd">
<td>15</td>
<td>true</td>
<td>9</td>
<td>0.046361</td>
<td>0.07837</td>
<td>0.05</td>
<td>0.92722</td>
<td>0.049715</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals">Confidence intervals</h2>
<p>If <code>conf_int</code> is set to <code>True</code>, <code>exp_stats()</code> will produce lower and upper confidence interval limits for the observed termination rate.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(exposed_data.</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    group_by(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>).</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    exp_stats(conf_int<span class="op">=</span><span class="va">True</span>).</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    data.select(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>, pl.col(<span class="st">'^q_obs.*$'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="conf1" class="cell-output cell-output-display" data-execution_count="18">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (30, 5)</small>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">pol_yr</th>
<th data-quarto-table-cell-role="th">inc_guar</th>
<th data-quarto-table-cell-role="th">q_obs</th>
<th data-quarto-table-cell-role="th">q_obs_lower</th>
<th data-quarto-table-cell-role="th">q_obs_upper</th>
</tr>
<tr class="odd">
<th>u32</th>
<th>bool</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>false</td>
<td>0.007254</td>
<td>0.005441</td>
<td>0.009197</td>
</tr>
<tr class="even">
<td>1</td>
<td>true</td>
<td>0.003989</td>
<td>0.002862</td>
<td>0.005203</td>
</tr>
<tr class="odd">
<td>2</td>
<td>false</td>
<td>0.012953</td>
<td>0.010418</td>
<td>0.015628</td>
</tr>
<tr class="even">
<td>2</td>
<td>true</td>
<td>0.006408</td>
<td>0.0049</td>
<td>0.00801</td>
</tr>
<tr class="odd">
<td>3</td>
<td>false</td>
<td>0.010393</td>
<td>0.008066</td>
<td>0.012874</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>13</td>
<td>true</td>
<td>0.043862</td>
<td>0.032225</td>
<td>0.056394</td>
</tr>
<tr class="even">
<td>14</td>
<td>false</td>
<td>0.125656</td>
<td>0.087578</td>
<td>0.167541</td>
</tr>
<tr class="odd">
<td>14</td>
<td>true</td>
<td>0.047602</td>
<td>0.031188</td>
<td>0.065658</td>
</tr>
<tr class="even">
<td>15</td>
<td>false</td>
<td>0.10804</td>
<td>0.040515</td>
<td>0.18907</td>
</tr>
<tr class="odd">
<td>15</td>
<td>true</td>
<td>0.046361</td>
<td>0.020605</td>
<td>0.077268</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>If no weighting variable is passed to <code>wt</code>, confidence intervals will be constructed assuming a binomial distribution of claims. However, if a weighting variable is supplied, a normal distribution for aggregate claims will be assumed with a mean equal to observed claims and a variance equal to:</p>
<p><span class="math display">\[
Var(S) = E(N) \times Var(X) + E(X)^2 \times Var(N)
\]</span></p>
<p>Where <code>S</code> is the aggregate claim random variable, <code>X</code> is the weighting variable assumed to follow a normal distribution, and <code>N</code> is a binomial random variable for the number of claims.</p>
<p>The default confidence level is 95%. This can be changed using the <code>conf_level</code> argument. Below, tighter confidence intervals are constructed by decreasing the confidence level to 90%.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(exposed_data.</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    group_by(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>).</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    exp_stats(conf_int <span class="op">=</span> <span class="va">True</span>, conf_level <span class="op">=</span> <span class="fl">0.9</span>).</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    data.select(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>, pl.col(<span class="st">'^q_obs.*$'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="conf2" class="cell-output cell-output-display" data-execution_count="19">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (30, 5)</small>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">pol_yr</th>
<th data-quarto-table-cell-role="th">inc_guar</th>
<th data-quarto-table-cell-role="th">q_obs</th>
<th data-quarto-table-cell-role="th">q_obs_lower</th>
<th data-quarto-table-cell-role="th">q_obs_upper</th>
</tr>
<tr class="odd">
<th>u32</th>
<th>bool</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>false</td>
<td>0.007254</td>
<td>0.0057</td>
<td>0.008938</td>
</tr>
<tr class="even">
<td>1</td>
<td>true</td>
<td>0.003989</td>
<td>0.003035</td>
<td>0.004943</td>
</tr>
<tr class="odd">
<td>2</td>
<td>false</td>
<td>0.012953</td>
<td>0.010841</td>
<td>0.015205</td>
</tr>
<tr class="even">
<td>2</td>
<td>true</td>
<td>0.006408</td>
<td>0.005183</td>
<td>0.007727</td>
</tr>
<tr class="odd">
<td>3</td>
<td>false</td>
<td>0.010393</td>
<td>0.008376</td>
<td>0.012564</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>13</td>
<td>true</td>
<td>0.043862</td>
<td>0.034016</td>
<td>0.053709</td>
</tr>
<tr class="even">
<td>14</td>
<td>false</td>
<td>0.125656</td>
<td>0.091386</td>
<td>0.159926</td>
</tr>
<tr class="odd">
<td>14</td>
<td>true</td>
<td>0.047602</td>
<td>0.034471</td>
<td>0.062375</td>
</tr>
<tr class="even">
<td>15</td>
<td>false</td>
<td>0.10804</td>
<td>0.05402</td>
<td>0.175565</td>
</tr>
<tr class="odd">
<td>15</td>
<td>true</td>
<td>0.046361</td>
<td>0.020605</td>
<td>0.072117</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>If expected values are passed to <code>expected</code>, the output will also contain confidence intervals around any actual-to-expected ratios.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(exposed_data.</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    group_by(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>).</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    exp_stats(conf_int <span class="op">=</span> <span class="va">True</span>, expected<span class="op">=</span><span class="st">'expected_1'</span>).</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    data.select(<span class="st">'pol_yr'</span>, <span class="st">'inc_guar'</span>, pl.col(<span class="st">'^ae.*$'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="conf3" class="cell-output cell-output-display" data-execution_count="20">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (30, 5)</small>
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">pol_yr</th>
<th data-quarto-table-cell-role="th">inc_guar</th>
<th data-quarto-table-cell-role="th">ae_expected_1</th>
<th data-quarto-table-cell-role="th">ae_expected_1_lower</th>
<th data-quarto-table-cell-role="th">ae_expected_1_upper</th>
</tr>
<tr class="odd">
<th>u32</th>
<th>bool</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>false</td>
<td>1.450814</td>
<td>1.08811</td>
<td>1.839425</td>
</tr>
<tr class="even">
<td>1</td>
<td>true</td>
<td>0.797752</td>
<td>0.572301</td>
<td>1.040546</td>
</tr>
<tr class="odd">
<td>2</td>
<td>false</td>
<td>1.665337</td>
<td>1.33951</td>
<td>2.009265</td>
</tr>
<tr class="even">
<td>2</td>
<td>true</td>
<td>0.823869</td>
<td>0.630017</td>
<td>1.029836</td>
</tr>
<tr class="odd">
<td>3</td>
<td>false</td>
<td>0.984559</td>
<td>0.764136</td>
<td>1.219678</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>13</td>
<td>true</td>
<td>0.877242</td>
<td>0.644504</td>
<td>1.127883</td>
</tr>
<tr class="even">
<td>14</td>
<td>false</td>
<td>2.513115</td>
<td>1.751565</td>
<td>3.35082</td>
</tr>
<tr class="odd">
<td>14</td>
<td>true</td>
<td>0.952043</td>
<td>0.623752</td>
<td>1.313162</td>
</tr>
<tr class="even">
<td>15</td>
<td>false</td>
<td>2.160806</td>
<td>0.810302</td>
<td>3.78141</td>
</tr>
<tr class="odd">
<td>15</td>
<td>true</td>
<td>0.92722</td>
<td>0.412098</td>
<td>1.545367</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Lastly, if <code>credibility</code> is <code>True</code> <em>and</em> expected values are passed to <code>expected</code>, confidence intervals will also be calculated for any credibility-weighted termination rates.</p>
</section>
<section id="miscellaneous" class="level2">
<h2 class="anchored" data-anchor-id="miscellaneous">Miscellaneous</h2>
<section id="summary-method" class="level3">
<h3 class="anchored" data-anchor-id="summary-method">Summary method</h3>
<p>As noted above, the result of <code>exp_stats()</code> is an <code>ExpStats</code> object. If the <code>summary()</code> function is applied to an <code>ExpStats</code> object, the data will be summarized again and return a higher level <code>ExpStats</code> object.</p>
<p>If no additional arguments are passed, <code>summary()</code> returns a single row of aggregate results.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>exp_res.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="summary1" class="cell-output cell-output-display" data-execution_count="21">
<pre><code>Experience study results

Target status: Surrender
Study range: 1900-01-01 to 2019-12-31
Expected values: expected_1, expected_2

shape: (1, 8)
┌──────────┬────────┬─────────────┬──────────┬────────────┬────────────┬─────────────┬─────────────┐
│ n_claims ┆ claims ┆ exposure    ┆ q_obs    ┆ expected_1 ┆ expected_2 ┆ ae_expected ┆ ae_expected │
│ ---      ┆ ---    ┆ ---         ┆ ---      ┆ ---        ┆ ---        ┆ _1          ┆ _2          │
│ u32      ┆ u32    ┆ f64         ┆ f64      ┆ f64        ┆ f64        ┆ ---         ┆ ---         │
│          ┆        ┆             ┆          ┆            ┆            ┆ f64         ┆ f64         │
╞══════════╪════════╪═════════════╪══════════╪════════════╪════════════╪═════════════╪═════════════╡
│ 2869     ┆ 2869   ┆ 132633.9007 ┆ 0.021631 ┆ 0.024242   ┆ 0.020895   ┆ 0.892305    ┆ 1.035233    │
│          ┆        ┆ 56          ┆          ┆            ┆            ┆             ┆             │
└──────────┴────────┴─────────────┴──────────┴────────────┴────────────┴─────────────┴─────────────┘</code></pre>
</div>
</div>
<p>If additional variable names are passed to the <code>summary()</code> method, then the output will group the data by those variables. In our example, if <code>pol_yr</code> is passed to <code>summary()</code>, the output will contain one row per policy year.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>exp_res.summary(<span class="st">'pol_yr'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="summary2" class="cell-output cell-output-display" data-execution_count="22">
<pre><code>Experience study results

Groups: pol_yr
Target status: Surrender
Study range: 1900-01-01 to 2019-12-31
Expected values: expected_1, expected_2

shape: (15, 9)
┌────────┬──────────┬────────┬─────────────┬───┬────────────┬────────────┬────────────┬────────────┐
│ pol_yr ┆ n_claims ┆ claims ┆ exposure    ┆ … ┆ expected_1 ┆ expected_2 ┆ ae_expecte ┆ ae_expecte │
│ ---    ┆ ---      ┆ ---    ┆ ---         ┆   ┆ ---        ┆ ---        ┆ d_1        ┆ d_2        │
│ u32    ┆ u32      ┆ u32    ┆ f64         ┆   ┆ f64        ┆ f64        ┆ ---        ┆ ---        │
│        ┆          ┆        ┆             ┆   ┆            ┆            ┆ f64        ┆ f64        │
╞════════╪══════════╪════════╪═════════════╪═══╪════════════╪════════════╪════════════╪════════════╡
│ 1      ┆ 102      ┆ 102    ┆ 19252.20778 ┆ … ┆ 0.005      ┆ 0.021015   ┆ 1.059619   ┆ 0.252113   │
│        ┆          ┆        ┆ 5           ┆   ┆            ┆            ┆            ┆            │
│ 2      ┆ 160      ┆ 160    ┆ 17714.76667 ┆ … ┆ 0.007778   ┆ 0.021014   ┆ 1.161259   ┆ 0.429803   │
│        ┆          ┆        ┆ 4           ┆   ┆            ┆            ┆            ┆            │
│ 3      ┆ 124      ┆ 124    ┆ 16097.13050 ┆ … ┆ 0.010556   ┆ 0.021008   ┆ 0.72978    ┆ 0.36669    │
│        ┆          ┆        ┆ 4           ┆   ┆            ┆            ┆            ┆            │
│ 4      ┆ 168      ┆ 168    ┆ 14535.85383 ┆ … ┆ 0.013333   ┆ 0.020984   ┆ 0.866822   ┆ 0.550781   │
│        ┆          ┆        ┆ 6           ┆   ┆            ┆            ┆            ┆            │
│ 5      ┆ 164      ┆ 164    ┆ 12915.52272 ┆ … ┆ 0.016111   ┆ 0.02093    ┆ 0.788145   ┆ 0.606686   │
│        ┆          ┆        ┆ 6           ┆   ┆            ┆            ┆            ┆            │
│ …      ┆ …        ┆ …      ┆ …           ┆ … ┆ …          ┆ …          ┆ …          ┆ …          │
│ 11     ┆ 804      ┆ 804    ┆ 4390.391496 ┆ … ┆ 0.2        ┆ 0.020786   ┆ 0.915636   ┆ 8.809981   │
│ 12     ┆ 330      ┆ 330    ┆ 2663.379931 ┆ … ┆ 0.15       ┆ 0.020041   ┆ 0.826018   ┆ 6.182451   │
│ 13     ┆ 99       ┆ 99     ┆ 1619.90935  ┆ … ┆ 0.05       ┆ 0.019656   ┆ 1.222291   ┆ 3.109275   │
│ 14     ┆ 62       ┆ 62     ┆ 871.838738  ┆ … ┆ 0.05       ┆ 0.019518   ┆ 1.422281   ┆ 3.643434   │
│ 15     ┆ 17       ┆ 17     ┆ 268.175058  ┆ … ┆ 0.05       ┆ 0.019142   ┆ 1.267829   ┆ 3.311695   │
└────────┴──────────┴────────┴─────────────┴───┴────────────┴────────────┴────────────┴────────────┘</code></pre>
</div>
</div>
<p>Similarly, if <code>inc_guar</code> is passed to <code>summary()</code>, the output will contain a row for each unique value in <code>inc_guar</code>.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>exp_res.summary(<span class="st">'inc_guar'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="summary3" class="cell-output cell-output-display" data-execution_count="23">
<pre><code>Experience study results

Groups: inc_guar
Target status: Surrender
Study range: 1900-01-01 to 2019-12-31
Expected values: expected_1, expected_2

shape: (2, 9)
┌──────────┬──────────┬────────┬────────────┬───┬────────────┬────────────┬────────────┬───────────┐
│ inc_guar ┆ n_claims ┆ claims ┆ exposure   ┆ … ┆ expected_1 ┆ expected_2 ┆ ae_expecte ┆ ae_expect │
│ ---      ┆ ---      ┆ ---    ┆ ---        ┆   ┆ ---        ┆ ---        ┆ d_1        ┆ ed_2      │
│ bool     ┆ u32      ┆ u32    ┆ f64        ┆   ┆ f64        ┆ f64        ┆ ---        ┆ ---       │
│          ┆          ┆        ┆            ┆   ┆            ┆            ┆ f64        ┆ f64       │
╞══════════╪══════════╪════════╪════════════╪═══╪════════════╪════════════╪════════════╪═══════════╡
│ false    ┆ 1601     ┆ 1601   ┆ 52123.2158 ┆ … ┆ 0.023481   ┆ 0.03       ┆ 1.308099   ┆ 1.023856  │
│          ┆          ┆        ┆ 84         ┆   ┆            ┆            ┆            ┆           │
│ true     ┆ 1268     ┆ 1268   ┆ 80510.6848 ┆ … ┆ 0.024734   ┆ 0.015      ┆ 0.636752   ┆ 1.049964  │
│          ┆          ┆        ┆ 72         ┆   ┆            ┆            ┆            ┆           │
└──────────┴──────────┴────────┴────────────┴───┴────────────┴────────────┴────────────┴───────────┘</code></pre>
</div>
</div>
</section>
<section id="column-names" class="level3">
<h3 class="anchored" data-anchor-id="column-names">Column names</h3>
<p>As a default, <code>exp_stats()</code> assumes the input data frame uses the following naming conventions:</p>
<ul>
<li>The exposure column is called <code>exposure</code></li>
<li>The status column is called <code>status</code></li>
</ul>
<p>These default names can be overridden using the <code>col_exposure</code> and <code>col_status</code> arguments.</p>
<p>For example, if the status column was called <code>curr_stat</code> in our data, we could write:</p>
<div id="col-names" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>exposed_data.exp_stats(col_status<span class="op">=</span><span class="st">"curr_stat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="limitations" class="level3">
<h3 class="anchored" data-anchor-id="limitations">Limitations</h3>
<p>The <code>exp_stats()</code> method only supports termination studies. It does not contain support for transaction studies or studies with multiple changes from an active to an inactive status. For information on transaction studies, see <a href="../articles/transactions.html">Transactions</a>.</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>See <a href="../articles/exposures.html">Exposures</a> for more information on creating exposure records.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This adjustment is not necessary on surrenders because the <code>expose()</code> function previously did this for us.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>When weights are supplied, additional columns are created containing the sum of weights, the sum of squared weights, and the number of records. These columns are used for re-summarizing the data (see the “Summary method” section on this page).<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>See Herzog, Thomas (1999). Introduction to Credibility Theory for more information on Limited Fluctuation Credibility.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>